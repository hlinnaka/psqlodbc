<?xml version="1.0" encoding="utf-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2003/01/wi">
  <Module 
    Id="psqlODBC"
    Guid="BD868C41-BB9B-4AA7-A3F1-DB1FA1A02610" 
    Version="$(var.VERSION)" 
    Language="1033">
    
    <Package 
      Id="A182B0DB-ED70-46C7-AED4-5C92D6F05756" 
      Description="PostgreSQL ODBC Driver"
      Keywords="PostgreSQL, ODBC" 
      Manufacturer="PostgreSQL Global Development Group" 
      InstallerVersion="110" 
      Platforms="Intel" 
      Languages="1033" 
      Compressed="yes" 
      SummaryCodepage="1252" />
    
    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="SystemFolder.A182B0DB_ED70_46C7_AED4_5C92D6F05756" Name="Redist">
        <Component Id="psqlodbc.dll.A182B0DB_ED70_46C7_AED4_5C92D6F05756" Guid="41B28294-AE87-43FE-B615-531CD4911047">
          <File Id="psqlodbc.dll.A182B0DB_ED70_46C7_AED4_5C92D6F05756" Name="psqlodbc.dll" KeyPath="yes" src="../Release/psqlodbc.dll" />
          
          <!-- Note, installing the driver properly (IE, using ODBCDriver) has proven unreliable -->
          <!--       so we install the registry keys manually ourselves.                         -->
          <Registry Id="psqlodbc.reg.1.A182B0DB_ED70_46C7_AED4_5C92D6F05756" Root="HKLM" Key="SOFTWARE\ODBC\ODBCINST.INI\ODBC Drivers" Name="PostgreSQL" Type="string" Value="Installed" />
          <Registry Id="psqlodbc.reg.2.A182B0DB_ED70_46C7_AED4_5C92D6F05756" Root="HKLM" Key="SOFTWARE\ODBC\ODBCINST.INI\PostgreSQL" Name="APILevel" Type="string" Value="1" />
          <Registry Id="psqlodbc.reg.3.A182B0DB_ED70_46C7_AED4_5C92D6F05756" Root="HKLM" Key="SOFTWARE\ODBC\ODBCINST.INI\PostgreSQL" Name="ConnectFunctions" Type="string" Value="YYN" />
          <Registry Id="psqlodbc.reg.4.A182B0DB_ED70_46C7_AED4_5C92D6F05756" Root="HKLM" Key="SOFTWARE\ODBC\ODBCINST.INI\PostgreSQL" Name="Driver" Type="string" Value="[#psqlodbc.dll.A182B0DB_ED70_46C7_AED4_5C92D6F05756]" />
          <Registry Id="psqlodbc.reg.5.A182B0DB_ED70_46C7_AED4_5C92D6F05756" Root="HKLM" Key="SOFTWARE\ODBC\ODBCINST.INI\PostgreSQL" Name="DriverODBCVer" Type="string" Value="03.00" />
          <Registry Id="psqlodbc.reg.6.A182B0DB_ED70_46C7_AED4_5C92D6F05756" Root="HKLM" Key="SOFTWARE\ODBC\ODBCINST.INI\PostgreSQL" Name="FileUsage" Type="string" Value="0" />
          <Registry Id="psqlodbc.reg.7.A182B0DB_ED70_46C7_AED4_5C92D6F05756" Root="HKLM" Key="SOFTWARE\ODBC\ODBCINST.INI\PostgreSQL" Name="Setup" Type="string" Value="[#psqlodbc.dll.A182B0DB_ED70_46C7_AED4_5C92D6F05756]" />
          <Registry Id="psqlodbc.reg.8.A182B0DB_ED70_46C7_AED4_5C92D6F05756" Root="HKLM" Key="SOFTWARE\ODBC\ODBCINST.INI\PostgreSQL" Name="SQLLevel" Type="string" Value="1" />
          <Registry Id="psqlodbc.reg.9.A182B0DB_ED70_46C7_AED4_5C92D6F05756" Root="HKLM" Key="SOFTWARE\ODBC\ODBCINST.INI\PostgreSQL" Name="UsageCount" Type="integer" Value="1" />
        </Component>
      </Directory>
    </Directory>
     
  </Module>
</Wix>