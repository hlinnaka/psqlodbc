<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="12.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Debug|Win32">
      <Configuration>Debug</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Debug|x64">
      <Configuration>Debug</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|Win32">
      <Configuration>Release</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>

  <PropertyGroup Label="Globals">
    <ProjectGuid>{79F872B5-9FAF-43DF-B441-9C860EAE52CF}</ProjectGuid>
    <Keyword>Win32Proj</Keyword>
    <RootNamespace>psqlodbc</RootNamespace>
    <ProjectName>psqlodbc</ProjectName>
  </PropertyGroup>

  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.default.props" />

  <Import Project="psqlodbc.common.props" />
  <Import Project="psqlodbc.Cpp.props" />

  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />

  <PropertyGroup>
    <!-- The Link step uses this to determine the name of the output DLL file -->
    <TargetName>$(MAINDLL)</TargetName>
  </PropertyGroup>

  <!-- USE_LIBPQ -->
  <ItemDefinitionGroup Condition="$(USE_LIBPQ)" >
    <ClCompile>
      <PreprocessorDefinitions>USE_LIBPQ;USE_SSL;RESET_CRYPTO_CALLBACKS;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <AdditionalIncludeDirectories>$(PG_INC);$(SSL_INC);%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
    </ClCompile>
    <Link>
      <AdditionalLibraryDirectories>$(PG_LIB);$(SSL_LIB);%(AdditionalLibraryDirectories)</AdditionalLibraryDirectories>
      <DelayLoadDLLs>libpq.dll;ssleay32.dll;libeay32.dll;%(DelayLoadDLLs)</DelayLoadDLLs>
    </Link>
  </ItemDefinitionGroup>

  <!-- USE_GSS -->
  <ItemDefinitionGroup Condition="$(USE_GSS)">
    <ClCompile>
      <PreprocessorDefinitions>USE_GSS;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <AdditionalIncludeDirectories>$(GSS_INC);%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
    </ClCompile>
    <Link>
      <AdditionalLibraryDirectories>$(GSS_LIB);%(AdditionalLibraryDirectories)</AdditionalLibraryDirectories>
      <DelayLoadDLLs Condition="'$(Platform)'=='Win32'">gssapi32.dll;%(DelayLoadDLLs)</DelayLoadDLLs>
      <DelayLoadDLLs Condition="'$(Platform)'=='x64'">gssapi64.dll;%(DelayLoadDLLs)</DelayLoadDLLs>
    </Link>
  </ItemDefinitionGroup>

  <!-- USE_SSPI -->
  <ItemDefinitionGroup Condition="$(USE_SSPI)">
    <ClCompile>
      <PreprocessorDefinitions>USE_SSPI;%(PreprocessorDefinitions)</PreprocessorDefinitions>
    </ClCompile>
    <Link>
      <DelayLoadDLLs>secur32.dll;crypt32.dll;%(DelayLoadDLLs)</DelayLoadDLLs>
    </Link>
  </ItemDefinitionGroup>

  <ItemDefinitionGroup Condition="$(MSDTC)">
    <Link>
      <DelayLoadDLLs>$(DTCDLL).dll;%(DelayLoadDLLs)</DelayLoadDLLs>
    </Link>
  </ItemDefinitionGroup>

  <ItemDefinitionGroup>
    <Link>
      <AdditionalLibraryDirectories>$(OutDir);%(AdditionalLibraryDirectories)</AdditionalLibraryDirectories>
      <AdditionalDependencies>advapi32.lib;shell32.lib;ole32.lib;oleaut32.lib;uuid.lib;odbc32.lib;wsock32.lib;ws2_32.lib;winmm.lib;%(AdditionalDependencies)</AdditionalDependencies>
      <ModuleDefinitionFile>$(MAINDEF)</ModuleDefinitionFile>
      <SupportUnloadOfDelayLoadedDLL>true</SupportUnloadOfDelayLoadedDLL>
    </Link>

    <ResourceCompile>
      <PreprocessorDefinitions>$(PG_DRVFILE_VERSION);%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <PreprocessorDefinitions Condition="!$(ANSI_VERSION)">UNICODE_SUPPORT;%(PreprocessorDefinitions)</PreprocessorDefinitions>
    </ResourceCompile>
  </ItemDefinitionGroup>

  <Target Name="BuildImportLib">
   <MakeDir Directories="$(OutDir)"/>
   <Exec command='lib /def:$(MAINDEF) /machine:$(TARGET_CPU) /out:"$(OutDir)$(MAINDLL).lib"' />
  </Target>

  <ItemGroup>
    <Text Include="ReadMe.txt" />
  </ItemGroup>
  <ItemGroup>
    <ClInclude Include="catfunc.h" />
  </ItemGroup>
  <ItemGroup>
    <ClCompile Include="$(srcPath)bind.c" />
    <ClCompile Include="$(srcPath)columninfo.c" />
    <ClCompile Include="$(srcPath)connection.c" />
    <ClCompile Include="$(srcPath)convert.c" />
    <ClCompile Include="$(srcPath)descriptor.c" />
    <ClCompile Include="$(srcPath)dlg_specific.c" />
    <ClCompile Include="$(srcPath)dlg_wingui.c" />
    <ClCompile Include="$(srcPath)drvconn.c" />
    <ClCompile Include="$(srcPath)environ.c" />
    <ClCompile Include="$(srcPath)execute.c" />
    <ClCompile Include="$(srcPath)info.c" />
    <ClCompile Include="$(srcPath)info30.c" />
    <ClCompile Condition="$(MEMORY_DEBUG)" Include="$(srcPath)inouealc.c" />
    <ClCompile Include="$(srcPath)loadlib.c" />
    <ClCompile Include="$(srcPath)lobj.c" />
    <ClCompile Include="$(srcPath)misc.c" />
    <ClCompile Include="$(srcPath)multibyte.c" />
    <ClCompile Include="$(srcPath)mylog.c" />
    <ClCompile Include="$(srcPath)odbcapi.c" />
    <ClCompile Include="$(srcPath)odbcapi30.c" />
    <ClCompile Condition="!$(ANSI_VERSION)" Include="$(srcPath)odbcapi30w.c" />
    <ClCompile Condition="!$(ANSI_VERSION)" Include="$(srcPath)odbcapiw.c" />
    <ClCompile Include="$(srcPath)options.c" />
    <ClCompile Include="$(srcPath)parse.c" />
    <ClCompile Include="$(srcPath)pgapi30.c" />
    <ClCompile Include="$(srcPath)pgtypes.c" />
    <ClCompile Include="$(srcPath)psqlodbc.c" />
    <ClCompile Include="$(srcPath)qresult.c" />
    <ClCompile Include="$(srcPath)results.c" />
    <ClCompile Include="$(srcPath)setup.c" />
    <ClCompile Include="$(srcPath)socket.c" />
    <ClCompile Condition="$(USE_GSS)" Include="$(srcPath)gsssvcs.c" />
    <ClCompile Condition="$(USE_SSPI)" Include="$(srcPath)sspisvcs.c" />
    <ClCompile Include="$(srcPath)statement.c" />
    <ClCompile Include="$(srcPath)tuple.c" />
    <ClCompile Include="$(srcPath)win_md5.c" />
    <ClCompile Condition="!$(ANSI_VERSION)" Include="$(srcPath)win_unicode.c" />
    <ClCompile Condition="$(MSDTC)" Include="$(srcPath)xalibname.c" />
  </ItemGroup>
  <ItemGroup>
    <ResourceCompile Include="$(srcPath)psqlodbc.rc" />
  </ItemGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
</Project>
